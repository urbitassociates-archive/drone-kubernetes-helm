deploy:
  kubernetes-helm:
    image: mandrean/drone-kubernetes-helm
    config:
      kubeconfig: cGlWZXJzaW9uOiB2MQpjbHVzdGVyczoKLSBjbHVzdGVyOgogICAgY2VydGlmaWNhdGUtYXV0aG9yaXR5OiB+Ly5taW5pa3ViZS9jYS5jcnQKICAgIHNlcnZlcjogaHR0cHM6Ly8xOTIuMTY4Ljk5LjEwMDo4NDQzCiAgbmFtZTogbWluaWt1YmUKY29udGV4dHM6Ci0gY29udGV4dDoKICAgIGNsdXN0ZXI6IG1pbmlrdWJlCiAgICB1c2VyOiBtaW5pa3ViZQogIG5hbWU6IG1pbmlrdWJlCmN1cnJlbnQtY29udGV4dDogbWluaWt1YmUKa2luZDogQ29uZmlnCnByZWZlcmVuY2VzOiB7fQp1c2VyczoKLSBuYW1lOiBtaW5pa3ViZQogIHVzZXI6CiAgICBjbGllbnQtY2VydGlmaWNhdGU6IH4vLm1pbmlrdWJlL2FwaXNlcnZlci5jcnQKICAgIGNsaWVudC1rZXk6IH4vLm1pbmlrdWJlL2FwaXNlcnZlci5rZXkKCg==
      credentials:
        certificate-authority: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM1ekNDQWMrZ0F3SUJBZ0lCQVRBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwdGFXNXAKYTNWaVpVTkJNQjRYRFRFMk1UQXhNekV6TVRReE4xb1hEVEkyTVRBeE1URXpNVFF4TjFvd0ZURVRNQkVHQTFVRQpBeE1LYldsdWFXdDFZbVZEUVRDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBTFkyCkQzTkxsS2NjYWZjS0pDQW85NkdCZFdrVTBmZVZUbjBUd0FONDlTVXBEYkVRU210c1UweEg3bmtGbDhrQms0cVUKQnArYXdZZ1dJdXcyNFlKMGhDNy9vWEdrU1REeUNUQStadFU2Y3RKcmxTSm9EZGJKd0JwMG9Sd3lSYnZ6Tnd1MAp1Uzlkck9BREc3TTdocUh2STB3aGJJdTZ3U1IwTnJMNlZNejFyNE9nMzBOSUVhQW1ENG4rRVBUZU83ajBLMlhZCjZ3VHdNbVVuZXRFZGVLdXc2MWtmTHRPUlRxNVBxWlV2VGx0bEFDQVdaUCtVUk1USWtUNHdtVHRVZHg2OEI2SzEKMXRWS0tKTTQwYWdjOURiSENnUFpGREhhMHY3dTVRSHRnV2VjSlB1RTJ5b0NpTk5IV0ZuUTVmVVIvMEpCOVQ4Tgo3QXZObytHeURYQTRoaTBkdDkwQ0F3RUFBYU5DTUVBd0RnWURWUjBQQVFIL0JBUURBZ0trTUIwR0ExVWRKUVFXCk1CUUdDQ3NHQVFVRkJ3TUNCZ2dyQmdFRkJRY0RBVEFQQmdOVkhSTUJBZjhFQlRBREFRSC9NQTBHQ1NxR1NJYjMKRFFFQkN3VUFBNElCQVFDWGc2RFhNamtnWHk4V25jbE95TSthMWZoSTBIVis4UU1UUExzQmc1RXdSUkJDbUtuQgppY0NVNEZXTU8vcXRDWHNrSlk0TFkzdXIzK0dhaTR1MjZXUkxlSVJWTEE3L3J6WVZxSWVlZ1R4dUR0Zm5Ra2E2ClBHVkxkeFhHck5vQ2Z1d0txaUdreWhnTkV3MU9xRHBmd0pDUzhEVmtIdjFhNURWSXNycEZaRXM2VmFHcXVLZmMKMFBsMVJuNFArejNnSWFQQTQ3aG4veEp1NHM5Y0tXN3R1NzE3dUtiUTFsWVRwcWs2OVljQ0lMVzZTbVJZMmZQSQoxUG1WZnhIbUxBSkxWTHl5UTlEMEZKUWtlUmJRUEFZb1pJcWd4a05OWWorb25uVU4wcW9RN0xpNHovVkhyMVdSCk9PTTZyOEhyL2FVNGZYUlVBbW5XUS9RanNiaSsvcjRsZDJRawotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
        client-certificate: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURXVENDQWtHZ0F3SUJBZ0lCQWpBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwdGFXNXAKYTNWaVpVTkJNQjRYRFRFMk1USXdOakUzTURJd01Gb1hEVEUzTVRJd05qRTNNREl3TUZvd0V6RVJNQThHQTFVRQpBeE1JYldsdWFXdDFZbVV3Z2dFaU1BMEdDU3FHU0liM0RRRUJBUVVBQTRJQkR3QXdnZ0VLQW9JQkFRQzBGRThFCmNqMGp3dnVVMVBWcEZjQWMvdklHSEtqZzdrM2tSTmVNVWluOURNRDY2NEdoWTZjejNkY01WM3Z4dWR2QWJzMTgKMjRGWEhUeVFkb3VNeExnNjk1cktvMHU0cjJOUWpZazJ5cHhnYjB5UE1tM1dXbU9TQlZZMUpWQks5VGtJUWw4MwptL3VqYUh4aGMyblNNOXFIVEJHTkdOS2lsZEY1SnNna0JPNmt6TVVkbVBIbm8wMzY1UDlqNHBGZjJTdzFJSzg4CkJFL0V3MEM1T1Babk5lTUE2UThUZHRUcjJ1cStna1d4UnV6Q3RjbzNncUEyNGJNQ25jYkdYU3I3UDFqWVJrRkcKNXRuRkpNVHBNNWpiSEcwZG93dncwOG9YQmJZdUZhRUV5VCtIb1ZuWTdNanY0N3hPNFUzQ3huVU5jNjRoaU5xNQpHeFp6bzIyVlVQNWJEdGtQQWdNQkFBR2pnYlV3Z2JJd0RnWURWUjBQQVFIL0JBUURBZ1dnTUIwR0ExVWRKUVFXCk1CUUdDQ3NHQVFVRkJ3TUJCZ2dyQmdFRkJRY0RBakFNQmdOVkhSTUJBZjhFQWpBQU1ITUdBMVVkRVFSc01HcUMKSkd0MVltVnlibVYwWlhNdVpHVm1ZWFZzZEM1emRtTXVZMngxYzNSbGNpNXNiMk5oYklJV2EzVmlaWEp1WlhSbApjeTVrWldaaGRXeDBMbk4yWTRJU2EzVmlaWEp1WlhSbGN5NWtaV1poZFd4MGdncHJkV0psY201bGRHVnpod1RBCnFHTmtod1FLQUFBQk1BMEdDU3FHU0liM0RRRUJDd1VBQTRJQkFRQkx3Rk9xQk9VUGQxdHpNU1BMZDlENElpQ0sKcW1STkk2Mmw1Y05VQ0o0dE9KOGFUdDZvRitNMTNlMC9McHZDYVU0NXRxcmc2dVNaQmtsRUdsSXM0Q2w3V3dZVwoxeDlWRzAzU1R0QVBPVkFRZ0ZCUCtFOXZiZEJFVUhCWS9xUnFvZmhjYjhMK3BBK2pKcGphLzVXY0lycG8xdENjCkNLUThTUHArYzIwaUtlbkdzVlQ0aDJub1RDRHFpUlAycWt6Y3VGRG1zbUo1Q0k4Tk01UHhSZmNBYkRDdXg3RTUKWUUrOVB4aVdKNXZiaUpZL1ZaK05ISmQ0cVNNa3E0N1p5NGYxYitaTGx2dVNQOE1WRTdrNDYrekZ4bHJJY21YeQpnY1Jka0tuY0t6UENmM0E3dnJTZ1JtNWRjcnhuZG9DUWxia212TVIwWEorZmYyODBVUzVrQzY5TVdUTGsKLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=
        client-key: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb2dJQkFBS0NBUUVBdEJSUEJISTlJOEw3bE5UMWFSWEFIUDd5Qmh5bzRPNU41RVRYakZJcC9RekErdXVCCm9XT25NOTNYREZkNzhibmJ3RzdOZk51QlZ4MDhrSGFMak1TNE92ZWF5cU5MdUs5alVJMkpOc3FjWUc5TWp6SnQKMWxwamtnVldOU1ZRU3ZVNUNFSmZONXY3bzJoOFlYTnAwalBhaDB3UmpSalNvcFhSZVNiSUpBVHVwTXpGSFpqeAo1Nk5OK3VUL1krS1JYOWtzTlNDdlBBUlB4TU5BdVRqMlp6WGpBT2tQRTNiVTY5cnF2b0pGc1Vic3dyWEtONEtnCk51R3pBcDNHeGwwcSt6OVkyRVpCUnViWnhTVEU2VE9ZMnh4dEhhTUw4TlBLRndXMkxoV2hCTWsvaDZGWjJPekkKNytPOFR1Rk53c1oxRFhPdUlZamF1UnNXYzZOdGxWRCtXdzdaRHdJREFRQUJBb0lCQUFkYkVRTTRlMkRibFJVMgpRYlFDTEcvQ3hqWVRzNTVFZmJBR1U5dXFlNGFYbjhaZ0dsSnlWS0VjdmEwR1ljeTA3OUlEZEtkVi9BbUg2ekpuCmRUblJ5MGkxVm9CU2ZVUlUvYlNMbzRBMmRIN0g3Uk9vVnE0NzBQZGsrbWwvVmJGS0pRTStXczlWc3Npdyt1dXMKSURWeTRzbEdCUzJEUnc5WEdWQmVraXhPZTBVRityaStwaEIvcWpjeDZuU0NZdWlGVUd6N29pazJKdW1NZXhsRgpwZWdGTG04TnBUajh3bHhXQ2lIdDlIMld3aWtab3JyeVo0RGI1MDhNdVdCKzlSQnBqSzFMNnNaZk5IRjdxMDR5ClNOZjczWFBYNnp3TlJ4Y1d1cEZSaGlpWHZMRGJ0czRjRjhNU1pIM2I4SzVlTVBrUFZkbER0L2ZycTVIWGh3blUKWThublhoa0NnWUVBMVkzMG5qNjhnalplL09pNXdoN1NBb253N1NQL3dXazFZT2h6Szl3a0ZZdUZxc0VYSUFURgp3TzhyY25CRmdCNEtvVGFFM1NqcXVndEVlb0h5dmNFc3Q4a1ZnRzdGNm9KRUl6RHJ4a1JmdnFwa29lWjRhd1RXCnhvaFdBWStFckVMNnNwYkh4emtOU1JCYkJaVExPRzc5aVd3SmREYm5IdXQwR1NPOHdnRjZQK3NDZ1lFQTE5OFQKRlh5T0xML1ROMUxScHJkTTRib1pYZndRWnZ5bTlvRFp3cnU4amFhNXVBaGJ3S2Z0MEpjeVFTeit4VTRrdUszZwpYRkxIYmJ2MXRQWGZPM2JWbStqNlBOa1dQZVlDc2k1VGxNbGFWU2ovOWZMNWJ1a1Vlc2lrL2daQWlCNUR6Z0ZSClM1NjVhNnBhYnBmYStpSHNLS3NGRVc3VEpKNitmNkpQSWRVZVptMENnWUFlalZDUjB5ZmsrU0pkekczRzkrSFQKdXloY3hPbXlJZnNoQWlCNEJlYWpybkpSRzQ3VFpkdGszdEs0YkplRTNNZG9pUVE1SDhGMUhHZVBuMGU3SGdmbgp3enp3UXVqTnhCVTdjNlJIbVVDWlpvYy9JbG5YOWJsRWJmemYvRWhlM0xaQkZwRStUMHMzU0wrODdLeW1SanEvCmpsVkw2dzdsdlltK2p2NVNReVBhUVFLQmdGN0p4QTUyUDlPa2MzRmllMDV5UkY4Rm9XZmthNnRkRzA4NEt1WlkKR3lZejVHN0x0TVkydHJVVi91b2hnTWxRVTgySUEvRm1JODJxYit5QzNmKzFZWHh4WTVmZVZ1YmRIYWZ4c1ordQpmbXpRY1B3bE1hT2kwdXhMT0MrV3ZUVkgzTXdUUmdnbmJSRzZuclRiRnpzb05CTnpiT2xIdVl6bDY0NE56aU56CitrSk5Bb0dBV002YmdSdm1vNVVwaEpIb0tYV2xiaXVzMjllU09lYlpBUlRtS2l1bjZuRUZKZmdaN1FyQi9VUWIKMng0YzAvVEVtYVAxWkhDT096UXZ0TmhRL083MlR2TUpzSXhHV01YTmVabFA3SXUxOTNXUjNlTmZFbjVWQU5DcApLcG9ZNzU4cjVZODZyUG8ybERWampHMFZOY0J0TDZ6clQ2MmtVVHZybjJMN0k2MTh5dTA9Ci0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg==
    commands:
    - install:
        chart: nginx
        release: dev-nginx
        flags:
        - dry-run: true
    - get:
        command: values
        release: dev-nginx
        flags:
        - all: true
        - output: ./values-dev.yaml
    - upgrade:
        chart: nginx
        release: dev-nginx
        flags:
        - namespace: default
        - values: ./values-dev.yaml
        - set: imageTag=1.10-alpine
